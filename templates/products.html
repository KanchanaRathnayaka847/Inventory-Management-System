{% extends 'base.html' %}

{% block title %}Products - Inventory System{% endblock %}

{% block content %}
  <div class="card">
    <div class="toolbar">
      <h1 style="margin:0">Products</h1>
      <div style="margin-left:auto">{% if current_user %}<a class="button" href="{{ url_for('add_product') }}">Add product</a>{% endif %}</div>
    </div>
    {% if products %}
      <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Category</th>
          <th>Quantity</th>
          <th>Price</th>
          <th>Reorder Level</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for p in products %}
        <tr>
          <td>{{ p.name }}</td>
          <td>{{ p.category_rel.name if p.category_rel else p.category }}</td>
            <td>
              {{ p.quantity }}
              {% if p.quantity < p.reorder_level %}
                <span class="reorder">(Below reorder level)</span>
              {% endif %}
            </td>
          <td>{{ '%.2f'|format(p.price) }}</td>
          <td>{{ p.reorder_level }}</td>
          <td>
            {% if current_user %}
                <a class="button" href="{{ url_for('edit_product', product_id=p.id) }}">Edit</a>
                <form method="post" action="{{ url_for('delete_product', product_id=p.id) }}" style="display:inline">
                  <button class="button btn-ghost" type="submit">Delete</button>
                </form>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
      </table>
  {% else %}
      <p>No products yet.</p>
  {% endif %}
  </div>
{% endblock %}
